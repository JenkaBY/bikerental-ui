{"openapi":"3.1.0","info":{"title":"Bike Rental API","description":"REST API for the Bike Rental management system","contact":{"name":"Bike Rental Team"},"version":"commit: 70b3114"},"servers":[{"url":"http://localhost:8080","description":"Generated server url"}],"tags":[{"name":"Customers","description":"Customer search and profile management"},{"name":"Equipment","description":"Equipment catalog management"},{"name":"Equipment Types","description":"Equipment type catalog"},{"name":"Equipment Statuses","description":"Equipment status catalog and allowed transitions"},{"name":"Finance","description":"Payment recording and history"},{"name":"Rentals","description":"Rental lifecycle management"},{"name":"Tariffs","description":"Tariff catalog and selection"}],"paths":{"/api/tariffs/{id}":{"get":{"tags":["Tariffs"],"summary":"Get tariff by ID","operationId":"getTariffById","parameters":[{"name":"id","in":"path","description":"Tariff ID","required":true,"schema":{"type":"integer","format":"int64","exclusiveMinimum":0},"example":1}],"responses":{"200":{"description":"Tariff found","content":{"*/*":{"schema":{"$ref":"#/components/schemas/TariffResponse"}}}},"404":{"description":"Tariff not found","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}},"500":{"description":"Internal server error","content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}}}},"put":{"tags":["Tariffs"],"summary":"Update tariff","description":"Replaces all fields of an existing tariff","operationId":"updateTariff","parameters":[{"name":"id","in":"path","description":"Tariff ID","required":true,"schema":{"type":"integer","format":"int64","exclusiveMinimum":0},"example":1}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TariffRequest"}}},"required":true},"responses":{"200":{"description":"Tariff updated","content":{"*/*":{"schema":{"$ref":"#/components/schemas/TariffResponse"}}}},"400":{"description":"Validation error","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}},"404":{"description":"Tariff not found","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}},"500":{"description":"Internal server error","content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}}}}},"/api/equipments/{id}":{"get":{"tags":["Equipment"],"summary":"Get equipment by ID","operationId":"getEquipmentById","parameters":[{"name":"id","in":"path","description":"Equipment ID","required":true,"schema":{"type":"integer","format":"int64"},"example":1}],"responses":{"200":{"description":"Equipment found","content":{"*/*":{"schema":{"$ref":"#/components/schemas/EquipmentResponse"}}}},"404":{"description":"Equipment not found","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}},"500":{"description":"Internal server error","content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}}}},"put":{"tags":["Equipment"],"summary":"Update equipment","description":"Replaces all fields of an existing equipment record","operationId":"updateEquipment","parameters":[{"name":"id","in":"path","description":"Equipment ID","required":true,"schema":{"type":"integer","format":"int64"},"example":1}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/EquipmentRequest"}}},"required":true},"responses":{"200":{"description":"Equipment updated","content":{"*/*":{"schema":{"$ref":"#/components/schemas/EquipmentResponse"}}}},"400":{"description":"Validation error","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}},"404":{"description":"Equipment not found","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}},"500":{"description":"Internal server error","content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}}}}},"/api/equipment-types/{slug}":{"put":{"tags":["Equipment Types"],"summary":"Update equipment type","operationId":"update","parameters":[{"name":"slug","in":"path","description":"Equipment type slug","required":true,"schema":{"type":"string","maxLength":50,"minLength":0},"example":"bike"}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/EquipmentTypeRequest"}}},"required":true},"responses":{"200":{"description":"Equipment type updated","content":{"*/*":{"schema":{"$ref":"#/components/schemas/EquipmentTypeResponse"}}}},"400":{"description":"Validation error","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}},"404":{"description":"Equipment type not found","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}},"500":{"description":"Internal server error","content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}}}}},"/api/equipment-statuses/{slug}":{"put":{"tags":["Equipment Statuses"],"summary":"Update equipment status","description":"Updates name, description and allowed transitions for a status","operationId":"update","parameters":[{"name":"slug","in":"path","description":"Equipment status slug","required":true,"schema":{"type":"string","maxLength":50,"minLength":0},"example":"available"}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/EquipmentStatusRequest"}}},"required":true},"responses":{"200":{"description":"Equipment status updated","content":{"*/*":{"schema":{"$ref":"#/components/schemas/EquipmentStatusResponse"}}}},"400":{"description":"Validation error","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}},"404":{"description":"Equipment status not found","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}},"422":{"description":"Invalid status transition","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}},"500":{"description":"Internal server error","content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}}}}},"/api/customers/{id}":{"put":{"tags":["Customers"],"summary":"Update customer","description":"Replaces all fields of an existing customer profile","operationId":"updateCustomer","parameters":[{"name":"id","in":"path","description":"Customer UUID","required":true,"schema":{"type":"string","format":"uuid"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CustomerRequest"}}},"required":true},"responses":{"200":{"description":"Customer updated","content":{"*/*":{"schema":{"$ref":"#/components/schemas/CustomerResponse"}}}},"400":{"description":"Validation error","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}},"404":{"description":"Customer not found","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}},"409":{"description":"Phone number already used by another customer","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}},"500":{"description":"Internal server error","content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}}}}},"/api/tariffs":{"get":{"tags":["Tariffs"],"summary":"Get all tariffs","description":"Returns a paginated list of all tariffs","operationId":"getAllTariffs","parameters":[{"name":"arg0","in":"query","required":true,"schema":{"$ref":"#/components/schemas/Pageable"}}],"responses":{"200":{"description":"Tariff page returned","content":{"*/*":{"schema":{"$ref":"#/components/schemas/PageTariffResponse"}}}},"500":{"description":"Internal server error","content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}}}},"post":{"tags":["Tariffs"],"summary":"Create tariff","operationId":"createTariff","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TariffRequest"}}},"required":true},"responses":{"201":{"description":"Tariff created","content":{"*/*":{"schema":{"$ref":"#/components/schemas/TariffResponse"}}}},"400":{"description":"Validation error","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}},"409":{"description":"Tariff conflict","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}},"500":{"description":"Internal server error","content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}}}}},"/api/rentals":{"get":{"tags":["Rentals"],"summary":"Search rentals","description":"Returns a paginated list of rentals filtered by status, customer or equipment UID","operationId":"getRentals","parameters":[{"name":"status","in":"query","description":"Rental status filter","required":false,"schema":{"type":"string","enum":["DRAFT","ACTIVE","COMPLETED","CANCELLED"]},"example":"ACTIVE"},{"name":"customerId","in":"query","description":"Customer UUID filter","required":false,"schema":{"type":"string","format":"uuid"}},{"name":"equipmentUid","in":"query","description":"Equipment UID filter","required":false,"schema":{"type":"string"},"example":"BIKE-001"},{"name":"arg3","in":"query","required":true,"schema":{"$ref":"#/components/schemas/Pageable"}}],"responses":{"200":{"description":"Rental page returned","content":{"*/*":{"schema":{"$ref":"#/components/schemas/PageRentalSummaryResponse"}}}},"400":{"description":"Invalid filter parameters","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}},"500":{"description":"Internal server error","content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}}}},"post":{"tags":["Rentals"],"summary":"Create rental (Fast Path)","description":"Creates an active rental in one step with all required data","operationId":"createRental","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateRentalRequest"}}},"required":true},"responses":{"201":{"description":"Rental created","content":{"*/*":{"schema":{"$ref":"#/components/schemas/RentalResponse"}}}},"400":{"description":"Validation error","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}},"404":{"description":"Customer or equipment not found","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}},"422":{"description":"Equipment not available","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}},"500":{"description":"Internal server error","content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}}}}},"/api/rentals/{id}/prepayments":{"post":{"tags":["Rentals"],"summary":"Record prepayment for rental","operationId":"recordPrepayment","parameters":[{"name":"id","in":"path","description":"Rental ID","required":true,"schema":{"type":"integer","format":"int64"},"example":1}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RecordPrepaymentRequest"}}},"required":true},"responses":{"201":{"description":"Prepayment recorded","content":{"*/*":{"schema":{"$ref":"#/components/schemas/PrepaymentResponse"}}}},"400":{"description":"Validation error","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}},"404":{"description":"Rental not found","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}},"500":{"description":"Internal server error","content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}}}}},"/api/rentals/return":{"post":{"tags":["Rentals"],"summary":"Return equipment","description":"Completes a rental by returning the rented equipment, calculates final cost and records additional payment if needed","operationId":"returnEquipment","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ReturnEquipmentRequest"}}},"required":true},"responses":{"200":{"description":"Equipment returned, rental completed","content":{"*/*":{"schema":{"$ref":"#/components/schemas/RentalReturnResponse"}}}},"400":{"description":"Validation error or rental identifier missing","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}},"404":{"description":"Rental or equipment not found","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}},"422":{"description":"Rental not in active state or insufficient prepayment","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}},"500":{"description":"Internal server error","content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}}}}},"/api/rentals/draft":{"post":{"tags":["Rentals"],"summary":"Create rental draft (Draft Path)","description":"Creates an empty rental draft to be filled step by step","operationId":"createDraft","responses":{"201":{"description":"Draft created","content":{"*/*":{"schema":{"$ref":"#/components/schemas/RentalResponse"}}}},"500":{"description":"Internal server error","content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}}}}},"/api/payments":{"post":{"tags":["Finance"],"summary":"Record payment","description":"Records a payment against a rental","operationId":"recordPayment","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RecordPaymentRequest"}}},"required":true},"responses":{"201":{"description":"Payment recorded","content":{"*/*":{"schema":{"$ref":"#/components/schemas/RecordPaymentResponse"}}}},"400":{"description":"Validation error","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}},"404":{"description":"Rental not found","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}},"500":{"description":"Internal server error","content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}}}}},"/api/equipments":{"get":{"tags":["Equipment"],"summary":"Search equipment","description":"Returns paginated equipment list filtered by status and/or type","operationId":"searchEquipments","parameters":[{"name":"status","in":"query","description":"Status slug filter","required":false,"schema":{"type":"string"},"example":"available"},{"name":"type","in":"query","description":"Type slug filter","required":false,"schema":{"type":"string"},"example":"bike"},{"name":"arg2","in":"query","required":true,"schema":{"$ref":"#/components/schemas/Pageable"}}],"responses":{"200":{"description":"Equipment page returned","content":{"*/*":{"schema":{"$ref":"#/components/schemas/PageEquipmentResponse"}}}},"400":{"description":"Invalid filter parameters","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}},"500":{"description":"Internal server error","content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}}}},"post":{"tags":["Equipment"],"summary":"Create equipment","description":"Registers a new piece of equipment in the catalog","operationId":"createEquipment","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/EquipmentRequest"}}},"required":true},"responses":{"201":{"description":"Equipment created","content":{"*/*":{"schema":{"$ref":"#/components/schemas/EquipmentResponse"}}}},"400":{"description":"Validation error","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}},"409":{"description":"Serial number already exists","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}},"500":{"description":"Internal server error","content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}}}}},"/api/equipment-types":{"get":{"tags":["Equipment Types"],"summary":"Get all equipment types","operationId":"getAllEquipmentTypes","responses":{"200":{"description":"Equipment types returned","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/EquipmentTypeResponse"}}}}},"500":{"description":"Internal server error","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/EquipmentTypeResponse"}}}}}}},"post":{"tags":["Equipment Types"],"summary":"Create equipment type","operationId":"create","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/EquipmentTypeRequest"}}},"required":true},"responses":{"201":{"description":"Equipment type created","content":{"*/*":{"schema":{"$ref":"#/components/schemas/EquipmentTypeResponse"}}}},"400":{"description":"Validation error","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}},"409":{"description":"Slug already exists","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}},"500":{"description":"Internal server error","content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}}}}},"/api/equipment-statuses":{"get":{"tags":["Equipment Statuses"],"summary":"Get all equipment statuses","description":"Returns all statuses with their allowed transitions","operationId":"getAllEquipmentStatuses","responses":{"200":{"description":"Equipment statuses returned","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/EquipmentStatusResponse"}}}}},"500":{"description":"Internal server error","content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}}}},"post":{"tags":["Equipment Statuses"],"summary":"Create equipment status","operationId":"create","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/EquipmentStatusRequest"}}},"required":true},"responses":{"201":{"description":"Equipment status created","content":{"*/*":{"schema":{"$ref":"#/components/schemas/EquipmentStatusResponse"}}}},"400":{"description":"Validation error","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}},"409":{"description":"Slug already exists","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}},"500":{"description":"Internal server error","content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}}}}},"/api/customers":{"get":{"tags":["Customers"],"summary":"Search customers by phone","description":"Returns customers whose phone number contains the given digit sequence","operationId":"searchByPhone","parameters":[{"name":"phone","in":"query","description":"Phone digits to search (4â€“11 digits)","required":true,"schema":{"type":"string","pattern":"^\\d{4,11}$"},"example":9161}],"responses":{"200":{"description":"Matching customers returned","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/CustomerSearchResponse"}}}}},"400":{"description":"Invalid phone search pattern","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}},"500":{"description":"Internal server error","content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}}}},"post":{"tags":["Customers"],"summary":"Create customer","description":"Creates a new customer profile","operationId":"createCustomer","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CustomerRequest"}}},"required":true},"responses":{"201":{"description":"Customer created","content":{"*/*":{"schema":{"$ref":"#/components/schemas/CustomerResponse"}}}},"400":{"description":"Validation error","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}},"409":{"description":"Phone number already exists","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}},"500":{"description":"Internal server error","content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}}}}},"/api/tariffs/{id}/deactivate":{"patch":{"tags":["Tariffs"],"summary":"Deactivate tariff","description":"Marks a tariff as inactive; it will no longer be selected for new rentals","operationId":"deactivateTariff","parameters":[{"name":"id","in":"path","description":"Tariff ID","required":true,"schema":{"type":"integer","format":"int64","exclusiveMinimum":0},"example":1}],"responses":{"200":{"description":"Tariff deactivated","content":{"*/*":{"schema":{"$ref":"#/components/schemas/TariffResponse"}}}},"404":{"description":"Tariff not found","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}},"500":{"description":"Internal server error","content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}}}}},"/api/tariffs/{id}/activate":{"patch":{"tags":["Tariffs"],"summary":"Activate tariff","description":"Marks a tariff as active so it can be used for rental pricing","operationId":"activateTariff","parameters":[{"name":"id","in":"path","description":"Tariff ID","required":true,"schema":{"type":"integer","format":"int64","exclusiveMinimum":0},"example":1}],"responses":{"200":{"description":"Tariff activated","content":{"*/*":{"schema":{"$ref":"#/components/schemas/TariffResponse"}}}},"404":{"description":"Tariff not found","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}},"500":{"description":"Internal server error","content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}}}}},"/api/rentals/{id}":{"get":{"tags":["Rentals"],"summary":"Get rental by ID","operationId":"getRentalById","parameters":[{"name":"id","in":"path","description":"Rental ID","required":true,"schema":{"type":"integer","format":"int64","exclusiveMinimum":0},"example":1}],"responses":{"200":{"description":"Rental found","content":{"*/*":{"schema":{"$ref":"#/components/schemas/RentalResponse"}}}},"400":{"description":"Invalid ID","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}},"404":{"description":"Rental not found","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}},"500":{"description":"Internal server error","content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}}}},"patch":{"tags":["Rentals"],"summary":"Update rental via JSON Patch (RFC 6902)","description":"Applies partial updates to a rental. Supported paths: /customerId, /equipmentId, /duration, /status. Setting status=ACTIVE activates the rental.","operationId":"updateRental","parameters":[{"name":"id","in":"path","description":"Rental ID","required":true,"schema":{"type":"integer","format":"int64"},"example":1}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RentalUpdateJsonPatchRequest"}}},"required":true},"responses":{"200":{"description":"Rental updated","content":{"*/*":{"schema":{"$ref":"#/components/schemas/RentalResponse"}}}},"400":{"description":"Invalid patch document","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}},"404":{"description":"Rental not found","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}},"422":{"description":"Invalid rental status transition or equipment not available","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}},"500":{"description":"Internal server error","content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}}}}},"/api/tariffs/selection":{"get":{"tags":["Tariffs"],"summary":"Select best tariff for rental","description":"Returns the most cost-effective tariff for the given equipment type, duration and date","operationId":"selectTariff","parameters":[{"name":"equipmentType","in":"query","description":"Equipment type slug","required":true,"schema":{"type":"string"},"example":"bike"},{"name":"durationMinutes","in":"query","description":"Rental duration in minutes","required":true,"schema":{"type":"integer","format":"int32","exclusiveMinimum":0},"example":120},{"name":"rentalDate","in":"query","description":"Rental date (ISO date, defaults to today)","required":false,"schema":{"type":"string","format":"date"},"example":"2026-06-01"}],"responses":{"200":{"description":"Tariff selected","content":{"*/*":{"schema":{"$ref":"#/components/schemas/TariffSelectionResponse"}}}},"400":{"description":"Invalid parameters","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}},"404":{"description":"No suitable tariff found","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}},"500":{"description":"Internal server error","content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}}}}},"/api/tariffs/active":{"get":{"tags":["Tariffs"],"summary":"Get active tariffs by equipment type","operationId":"getActiveTariffsByEquipmentType","parameters":[{"name":"equipmentType","in":"query","description":"Equipment type slug","required":true,"schema":{"type":"string"},"example":"bike"}],"responses":{"200":{"description":"Active tariffs returned","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/TariffResponse"}}}}},"400":{"description":"Invalid equipment type","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}},"500":{"description":"Internal server error","content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}}}}},"/api/payments/{id}":{"get":{"tags":["Finance"],"summary":"Get payment by ID","operationId":"getById","parameters":[{"name":"id","in":"path","description":"Payment UUID","required":true,"schema":{"type":"string","format":"uuid"}}],"responses":{"200":{"description":"Payment found","content":{"*/*":{"schema":{"$ref":"#/components/schemas/PaymentResponse"}}}},"404":{"description":"Payment not found","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}},"500":{"description":"Internal server error","content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}}}}},"/api/payments/by-rental/{rentalId}":{"get":{"tags":["Finance"],"summary":"Get payments by rental ID","description":"Returns all payments associated with a rental","operationId":"getByRental","parameters":[{"name":"rentalId","in":"path","description":"Rental ID","required":true,"schema":{"type":"integer","format":"int64","exclusiveMinimum":0},"example":42}],"responses":{"200":{"description":"Payments returned","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/PaymentResponse"}}}}},"400":{"description":"Invalid rental ID","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}},"500":{"description":"Internal server error","content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}}}}},"/api/equipments/by-uid/{uid}":{"get":{"tags":["Equipment"],"summary":"Get equipment by UID","operationId":"getEquipmentByUid","parameters":[{"name":"uid","in":"path","description":"Equipment UID","required":true,"schema":{"type":"string"},"example":"BIKE-001"}],"responses":{"200":{"description":"Equipment found","content":{"*/*":{"schema":{"$ref":"#/components/schemas/EquipmentResponse"}}}},"404":{"description":"Equipment not found","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}},"500":{"description":"Internal server error","content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}}}}},"/api/equipments/by-serial/{serialNumber}":{"get":{"tags":["Equipment"],"summary":"Get equipment by serial number","operationId":"getEquipmentBySerial","parameters":[{"name":"serialNumber","in":"path","description":"Serial number","required":true,"schema":{"type":"string"},"example":"SN-123456"}],"responses":{"200":{"description":"Equipment found","content":{"*/*":{"schema":{"$ref":"#/components/schemas/EquipmentResponse"}}}},"404":{"description":"Equipment not found","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}},"500":{"description":"Internal server error","content":{"application/problem+json":{"schema":{"$ref":"#/components/schemas/ProblemDetail"}}}}}}}},"components":{"schemas":{"TariffRequest":{"type":"object","description":"Request body for creating or updating a tariff","properties":{"name":{"type":"string","description":"Tariff name","example":"Standard Bike Rental","maxLength":200,"minLength":0},"description":{"type":"string","description":"Description","maxLength":1000,"minLength":0},"equipmentTypeSlug":{"type":"string","description":"Equipment type slug this tariff applies to","example":"bike"},"basePrice":{"type":"number","description":"Base price (entry fee)","example":50.0,"minimum":0.0},"halfHourPrice":{"type":"number","description":"Price per 30 minutes","example":100.0,"minimum":0.0},"hourPrice":{"type":"number","description":"Price per hour","example":180.0,"minimum":0.0},"dayPrice":{"type":"number","description":"Price per day","example":900.0,"minimum":0.0},"hourDiscountedPrice":{"type":"number","description":"Discounted price per hour (e.g. for bulk hours)","example":150.0,"minimum":0.0},"validFrom":{"type":"string","format":"date","description":"Date from which the tariff is valid","example":"2026-01-01"},"validTo":{"type":"string","format":"date","description":"Date until which the tariff is valid (null = indefinite)","example":"2026-12-31"},"status":{"type":"string","description":"Tariff status","enum":["ACTIVE","INACTIVE"]}},"required":["basePrice","dayPrice","halfHourPrice","hourDiscountedPrice","hourPrice","name","status","validFrom"]},"TariffResponse":{"type":"object","description":"Tariff details","properties":{"id":{"type":"integer","format":"int64","description":"Tariff ID","example":1},"name":{"type":"string","description":"Tariff name","example":"Standard Bike Rental"},"description":{"type":"string","description":"Description"},"equipmentTypeSlug":{"type":"string","description":"Equipment type slug","example":"bike"},"basePrice":{"type":"number","description":"Base price","example":50.0},"halfHourPrice":{"type":"number","description":"Price per 30 minutes","example":100.0},"hourPrice":{"type":"number","description":"Price per hour","example":180.0},"dayPrice":{"type":"number","description":"Price per day","example":900.0},"hourDiscountedPrice":{"type":"number","description":"Discounted price per hour","example":150.0},"validFrom":{"type":"string","format":"date","description":"Valid from date","example":"2026-01-01"},"validTo":{"type":"string","format":"date","description":"Valid to date (null = indefinite)","example":"2026-12-31"},"status":{"type":"string","description":"Tariff status","enum":["ACTIVE","INACTIVE"]}}},"ProblemDetail":{"type":"object","properties":{"type":{"type":"string","format":"uri"},"title":{"type":"string"},"status":{"type":"integer","format":"int32"},"detail":{"type":"string"},"instance":{"type":"string","format":"uri"},"properties":{"type":"object","additionalProperties":{}}}},"EquipmentRequest":{"type":"object","description":"Request body for creating or updating equipment","properties":{"serialNumber":{"type":"string","description":"Unique serial number","example":"SN-123456","maxLength":50,"minLength":0},"uid":{"type":"string","description":"Unique identifier tag (UID)","example":"BIKE-001","maxLength":100,"minLength":0},"typeSlug":{"type":"string","description":"Equipment type slug","example":"bike"},"statusSlug":{"type":"string","description":"Equipment status slug","example":"available"},"model":{"type":"string","description":"Model name","example":"Trek Marlin 5","maxLength":200,"minLength":0},"commissionedAt":{"type":"string","format":"date","description":"Date when equipment was put into service","example":"2023-06-01"},"condition":{"type":"string","description":"Condition description","example":"Good"}},"required":["serialNumber"]},"EquipmentResponse":{"type":"object","description":"Equipment record","properties":{"id":{"type":"integer","format":"int64","description":"Internal ID","example":1},"serialNumber":{"type":"string","description":"Serial number","example":"SN-123456"},"uid":{"type":"string","description":"UID tag","example":"BIKE-001"},"type":{"type":"string","description":"Equipment type slug","example":"bike"},"status":{"type":"string","description":"Equipment status slug","example":"available"},"model":{"type":"string","description":"Model name","example":"Trek Marlin 5"},"commissionedAt":{"type":"string","format":"date","description":"Commissioned date","example":"2023-06-01"},"condition":{"type":"string","description":"Condition","example":"Good"}}},"EquipmentTypeRequest":{"type":"object","description":"Request body for creating or updating an equipment type","properties":{"slug":{"type":"string","description":"URL-friendly identifier","example":"bike"},"name":{"type":"string","description":"Display name","example":"Bicycle"},"description":{"type":"string","description":"Description"}}},"EquipmentTypeResponse":{"type":"object","description":"Equipment type","properties":{"slug":{"type":"string","description":"Slug identifier","example":"bike"},"name":{"type":"string","description":"Display name","example":"Bicycle"},"description":{"type":"string","description":"Description"}}},"EquipmentStatusRequest":{"type":"object","description":"Request body for creating or updating an equipment status","properties":{"slug":{"type":"string","description":"URL-friendly identifier","example":"available"},"name":{"type":"string","description":"Display name","example":"Available"},"description":{"type":"string","description":"Description"},"allowedTransitions":{"type":"array","description":"Set of status slugs this status can transition to","example":["rented","maintenance"],"items":{"type":"string"},"uniqueItems":true}}},"EquipmentStatusResponse":{"type":"object","description":"Equipment status with allowed transitions","properties":{"slug":{"type":"string","description":"Slug identifier","example":"available"},"name":{"type":"string","description":"Display name","example":"Available"},"description":{"type":"string","description":"Description"},"allowedTransitions":{"type":"array","description":"Status slugs this status can transition to","items":{"type":"string"},"uniqueItems":true}}},"CustomerRequest":{"type":"object","description":"Request body for creating or updating a customer profile","properties":{"phone":{"type":"string","description":"Customer phone number","example":"+79161234567","minLength":1,"pattern":"^\\+?[0-9\\-\\s()]+$"},"firstName":{"type":"string","description":"First name","example":"Ivan","minLength":1},"lastName":{"type":"string","description":"Last name","example":"Ivanov","minLength":1},"email":{"type":"string","format":"email","description":"Email address","example":"ivan@example.com"},"birthDate":{"type":"string","format":"date","description":"Date of birth (must be in the past)","example":"1990-05-15"},"comments":{"type":"string","description":"Optional comments about the customer"}},"required":["firstName","lastName","phone"]},"CustomerResponse":{"type":"object","description":"Full customer profile","properties":{"id":{"type":"string","format":"uuid","description":"Customer UUID"},"phone":{"type":"string","description":"Phone number","example":"+79161234567"},"firstName":{"type":"string","description":"First name","example":"Ivan"},"lastName":{"type":"string","description":"Last name","example":"Ivanov"},"email":{"type":"string","description":"Email address","example":"ivan@example.com"},"birthDate":{"type":"string","format":"date","description":"Date of birth","example":"1990-05-15"},"comments":{"type":"string","description":"Comments"}}},"CreateRentalRequest":{"type":"object","description":"Request body for creating a rental via Fast Path","properties":{"customerId":{"type":"string","format":"uuid","description":"Customer UUID"},"equipmentId":{"type":"integer","format":"int64","description":"Equipment ID","example":1},"duration":{"type":"string","description":"Planned rental duration (ISO-8601)","example":"PT2H"},"tariffId":{"type":"integer","format":"int64","description":"Optional tariff ID; auto-selected if not provided","example":5}},"required":["customerId","duration","equipmentId"]},"RentalResponse":{"type":"object","description":"Full rental details","properties":{"id":{"type":"integer","format":"int64","description":"Rental ID","example":1},"customerId":{"type":"string","format":"uuid","description":"Customer UUID"},"equipmentId":{"type":"integer","format":"int64","description":"Equipment ID","example":1},"tariffId":{"type":"integer","format":"int64","description":"Tariff ID","example":3},"status":{"type":"string","description":"Rental status","example":"ACTIVE"},"startedAt":{"type":"string","format":"date-time","description":"Rental start time"},"expectedReturnAt":{"type":"string","format":"date-time","description":"Expected return time"},"actualReturnAt":{"type":"string","format":"date-time","description":"Actual return time (null if not returned)"},"plannedDurationMinutes":{"type":"integer","format":"int32","description":"Planned duration in minutes","example":120},"actualDurationMinutes":{"type":"integer","format":"int32","description":"Actual duration in minutes (null until returned)","example":130},"estimatedCost":{"type":"number","description":"Estimated rental cost","example":200.0},"finalCost":{"type":"number","description":"Final rental cost (null until returned)","example":250.0}}},"RecordPrepaymentRequest":{"type":"object","description":"Request body for recording a prepayment against a rental","properties":{"amount":{"type":"number","description":"Prepayment amount","example":200.0,"minimum":0.01},"paymentMethod":{"type":"string","description":"Payment method (e.g. CASH, CARD)","enum":["CASH","CARD","ELECTRONIC"]},"operatorId":{"type":"string","description":"Operator identifier","example":"operator-1","minLength":1}},"required":["amount","operatorId","paymentMethod"]},"PrepaymentResponse":{"type":"object","description":"Prepayment confirmation","properties":{"paymentId":{"type":"string","format":"uuid","description":"Payment UUID"},"amount":{"type":"number","description":"Amount paid","example":200.0},"paymentMethod":{"type":"string","description":"Payment method","enum":["CASH","CARD","ELECTRONIC"]},"receiptNumber":{"type":"string","description":"Receipt number","example":"RCP-20260228-001"},"createdAt":{"type":"string","format":"date-time","description":"Timestamp when payment was recorded"}}},"ReturnEquipmentRequest":{"type":"object","description":"Request body for returning rented equipment","properties":{"rentalId":{"type":"integer","format":"int64","description":"Rental ID","example":1},"equipmentId":{"type":"integer","format":"int64","description":"Equipment ID","example":1},"equipmentUid":{"type":"string","description":"Equipment UID","example":"BIKE-001"},"paymentMethod":{"type":"string","description":"Payment method for any additional charge","enum":["CASH","CARD","ELECTRONIC"]},"operatorId":{"type":"string","description":"Operator identifier","example":"operator-1"},"validIdentifier":{"type":"boolean"}}},"CostBreakdown":{"type":"object","description":"Detailed cost breakdown","properties":{"baseCost":{"type":"number","description":"Base cost for planned duration","example":200.0},"overtimeCost":{"type":"number","description":"Overtime cost","example":50.0},"totalCost":{"type":"number","description":"Total cost","example":250.0},"actualMinutes":{"type":"integer","format":"int32","description":"Actual rental duration in minutes","example":130},"billableMinutes":{"type":"integer","format":"int32","description":"Billable minutes (after forgiveness applied)","example":125},"plannedMinutes":{"type":"integer","format":"int32","description":"Planned duration in minutes","example":120},"overtimeMinutes":{"type":"integer","format":"int32","description":"Overtime minutes","example":10},"forgivenessApplied":{"type":"boolean","description":"Whether forgiveness rule was applied"},"calculationMessage":{"type":"string","description":"Human-readable calculation message"}}},"Money":{"type":"object","properties":{"amount":{"type":"number"},"zero":{"type":"boolean"},"negative":{"type":"boolean"},"positive":{"type":"boolean"},"negativeOrZero":{"type":"boolean"}}},"PaymentInfo":{"type":"object","properties":{"id":{"type":"string","format":"uuid"},"amount":{"$ref":"#/components/schemas/Money"},"paymentMethod":{"type":"string","enum":["CASH","CARD","ELECTRONIC"]},"receiptNumber":{"type":"string"},"createdAt":{"type":"string","format":"date-time"}}},"RentalReturnResponse":{"type":"object","description":"Result of equipment return operation","properties":{"rental":{"$ref":"#/components/schemas/RentalResponse","description":"Updated rental details"},"cost":{"$ref":"#/components/schemas/CostBreakdown","description":"Cost breakdown for the rental"},"additionalPayment":{"type":"number","description":"Additional payment charged at return (0 if prepayment covered all)","example":50.0},"paymentInfo":{"$ref":"#/components/schemas/PaymentInfo","description":"Payment info for the additional charge"}}},"RecordPaymentRequest":{"type":"object","description":"Request body for recording a payment","properties":{"rentalId":{"type":"integer","format":"int64","description":"Rental ID the payment is for","example":42},"amount":{"type":"number","description":"Payment amount","example":500.0,"minimum":0.01},"paymentType":{"type":"string","description":"Payment type (e.g. PREPAYMENT, FINAL)","enum":["PREPAYMENT","ADDITIONAL_PAYMENT","ACCESSORY","OTHER"]},"paymentMethod":{"type":"string","description":"Payment method (e.g. CASH, CARD)","enum":["CASH","CARD","ELECTRONIC"]},"operatorId":{"type":"string","description":"Operator identifier","example":"operator-1"}},"required":["amount","paymentMethod","paymentType"]},"RecordPaymentResponse":{"type":"object","description":"Result of recording a payment","properties":{"paymentId":{"type":"string","format":"uuid","description":"Payment UUID"},"receiptNumber":{"type":"string","description":"Receipt number","example":"RCP-20260228-001"}}},"RentalPatchOperation":{"type":"object","properties":{"op":{"type":"string","enum":["replace","add"]},"path":{"type":"string","minLength":1},"value":{}},"required":["op","path"]},"RentalUpdateJsonPatchRequest":{"type":"object","properties":{"operations":{"type":"array","items":{"$ref":"#/components/schemas/RentalPatchOperation"},"minItems":1}},"required":["operations"]},"Pageable":{"type":"object","properties":{"page":{"type":"integer","format":"int32","minimum":0},"size":{"type":"integer","format":"int32","minimum":1},"sort":{"type":"array","items":{"type":"string"}}}},"PageRequest":{"type":"object","properties":{"size":{"type":"integer","format":"int32"},"page":{"type":"integer","format":"int32"},"sortBy":{"type":"string"}}},"PageTariffResponse":{"type":"object","properties":{"items":{"type":"array","items":{"$ref":"#/components/schemas/TariffResponse"}},"totalItems":{"type":"integer","format":"int64"},"pageRequest":{"$ref":"#/components/schemas/PageRequest"}}},"TariffSelectionResponse":{"type":"object","description":"Result of tariff selection for a rental","properties":{"id":{"type":"integer","format":"int64","description":"Tariff ID","example":3},"name":{"type":"string","description":"Tariff name","example":"Standard Bike Rental"},"equipmentType":{"type":"string","description":"Equipment type slug","example":"bike"},"price":{"type":"number","description":"Price for the selected period","example":180.0},"period":{"type":"string","description":"Matched tariff period (e.g. HOUR, HALF_HOUR, DAY)","enum":["HALF_HOUR","HOUR","DAY"]}}},"PageRentalSummaryResponse":{"type":"object","properties":{"items":{"type":"array","items":{"$ref":"#/components/schemas/RentalSummaryResponse"}},"totalItems":{"type":"integer","format":"int64"},"pageRequest":{"$ref":"#/components/schemas/PageRequest"}}},"RentalSummaryResponse":{"type":"object","description":"Compact rental summary for list views","properties":{"id":{"type":"integer","format":"int64","description":"Rental ID","example":1},"customerId":{"type":"string","format":"uuid","description":"Customer UUID"},"equipmentId":{"type":"integer","format":"int64","description":"Equipment ID","example":1},"status":{"type":"string","description":"Rental status","example":"ACTIVE"},"startedAt":{"type":"string","format":"date-time","description":"Rental start time"},"expectedReturnAt":{"type":"string","format":"date-time","description":"Expected return time"},"overdueMinutes":{"type":"integer","format":"int32","description":"Overdue minutes (null if not overdue)","example":10}}},"PaymentResponse":{"type":"object","description":"Payment record","properties":{"id":{"type":"string","format":"uuid","description":"Payment UUID"},"rentalId":{"type":"integer","format":"int64","description":"Rental ID","example":42},"amount":{"type":"number","description":"Amount","example":500.0},"paymentType":{"type":"string","description":"Payment type","example":"PREPAYMENT"},"paymentMethod":{"type":"string","description":"Payment method","example":"CASH"},"createdAt":{"type":"string","format":"date-time","description":"Timestamp when payment was recorded"},"operatorId":{"type":"string","description":"Operator identifier","example":"operator-1"},"receiptNumber":{"type":"string","description":"Receipt number","example":"RCP-20260228-001"}}},"PageEquipmentResponse":{"type":"object","properties":{"items":{"type":"array","items":{"$ref":"#/components/schemas/EquipmentResponse"}},"totalItems":{"type":"integer","format":"int64"},"pageRequest":{"$ref":"#/components/schemas/PageRequest"}}},"CustomerSearchResponse":{"type":"object","description":"Compact customer info returned in search results","properties":{"id":{"type":"string","format":"uuid","description":"Customer UUID"},"phone":{"type":"string","description":"Phone number","example":"+79161234567"},"firstName":{"type":"string","description":"First name","example":"Ivan"},"lastName":{"type":"string","description":"Last name","example":"Ivanov"}}}}}}